#include <SPI.h>
#include "Firebase_Arduino_WiFiNINA.h"
#include "arduino_secrets.h"
#include <SoftwareSerial.h>

// Aquesta variable es pel sensor de distància.
SoftwareSerial mySerial(11,10); // RX, TX
int diposit;

// El path és important per llegir i enviar la informació a firebase. També creem un objecte de Firebase.
String path="/torretes";
FirebaseData fbdo;

//Paràmetres de la wifi
char ssidf[] = SECRET_SSIDF;
char passf[] = SECRET_PASSF;
char dbsf[] = SECRET_DBSF;
char fbhost[] = SECRET_FBHOST;

//Inicialitza la variable sense valor. Ja agafa el valor del servidor firebase.
byte freq;

// Inicialitza paràmetres del relé i els sensors. PINS dels relés i del sensors d'humitat.
const int pumpRelay[4] = { 2, 3, 4, 5 };
const int moistureSensor[4] = { A0, A1, A2, A3 };
const int ON = LOW;
const int OFF = HIGH;
bool rele[4] = { false, false, false, false };

// Inicialitza la variable sense valor per posteriorment recollira-la del servidor fb
int nivellHumitatProgramat[4];
int moistureLevelSensor[4];

// ********************************************************
// *            Inici de les funcions                     *
// ********************************************************

// Funció per inicialitzar relé i sensor d'humitat.
void initialize_waterPump() {
  //Inicialitza el relé i el sensor d'humitat
  for(byte i = 0; i < 4; i++) {
    pinMode(pumpRelay[i], OUTPUT);
    digitalWrite(pumpRelay[i], OFF);  
    pinMode(moistureSensor[i], INPUT);
  }
  delay(500);
}

//Aquesta funció inicialitza el sensor de distància.
void initialize_distanceSensor() {
  //Inicialitza el sensor de distància
  mySerial.begin(9600);
}
